# éƒ½å¸‚æ›´æ–°æœƒç®¡ç†ç³»çµ± - ç³»çµ±æ¶æ§‹èˆ‡ç‰©ä»¶é—œä¿‚èªªæ˜

> æ–‡ä»¶ç‰ˆæœ¬ï¼š1.0  
> æ›´æ–°æ—¥æœŸï¼š2025-12-06

---

## 1. ç³»çµ±æ¦‚è¿°

æœ¬ç³»çµ±ç‚º**å°ç£éƒ½å¸‚æ›´æ–°æœƒç®¡ç†å¹³å°**ï¼Œç”¨æ–¼ç®¡ç†éƒ½å¸‚æ›´æ–°æœƒçš„æ‰€æœ‰æ¬Šäººã€æœƒè­°ã€æŠ•ç¥¨ç­‰æ¥­å‹™æµç¨‹ã€‚

### 1.1 æŠ€è¡“æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Frontend (Nuxt 3)                       â”‚
â”‚                   Vue.js SPA + Nuxt UI                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ RESTful API (JSON)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Backend (CodeIgniter 4)                    â”‚
â”‚                      PHP 8.x + JWT Auth                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Database (MariaDB)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ ¸å¿ƒå¯¦é«”é—œä¿‚ (Entity Relationship)

### 2.1 ER åœ– (ç°¡åŒ–ç‰ˆ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       1:N       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Company    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   UrbanRenewal   â”‚
â”‚   (ä¼æ¥­)     â”‚                 â”‚   (éƒ½å¸‚æ›´æ–°æœƒ)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                  â”‚
       â”‚ 1:N                              â”‚ 1:N
       â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User     â”‚                 â”‚  PropertyOwner   â”‚
â”‚   (ä½¿ç”¨è€…)   â”‚                 â”‚   (æ‰€æœ‰æ¬Šäºº)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                 â”‚                 â”‚
                        â–¼ N:M             â–¼ N:M             â–¼ 1:N
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚   LandPlot   â”‚  â”‚   Building   â”‚  â”‚ MeetingAttendanceâ”‚
                â”‚   (åœŸåœ°)     â”‚  â”‚   (å»ºç‰©)     â”‚  â”‚    (å‡ºå¸­ç´€éŒ„)    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       1:N       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   UrbanRenewal   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚     Meeting      â”‚
â”‚   (éƒ½å¸‚æ›´æ–°æœƒ)   â”‚                 â”‚     (æœƒè­°)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â”‚ 1:N
                                              â–¼
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚   VotingTopic    â”‚
                                     â”‚   (æŠ•ç¥¨è­°é¡Œ)     â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â”‚ 1:N
                                              â–¼
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚  VotingRecord    â”‚
                                     â”‚   (æŠ•ç¥¨ç´€éŒ„)     â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. è³‡æ–™æ¨¡å‹è©³ç´°èªªæ˜

### 3.1 ä¼æ¥­èˆ‡ä½¿ç”¨è€…ç®¡ç†

#### Company (ä¼æ¥­)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `name` | ä¼æ¥­åç¨± |
| `tax_id` | çµ±ä¸€ç·¨è™Ÿ |
| `company_phone` | ä¼æ¥­é›»è©± |
| `max_renewal_count` | å¯ç®¡ç†çš„æ›´æ–°æœƒæ•¸é‡ä¸Šé™ |
| `max_issue_count` | å¯å»ºç«‹çš„è­°é¡Œæ•¸é‡ä¸Šé™ |

**é—œè¯**ï¼š
- ä¸€å€‹ä¼æ¥­å¯ç®¡ç†**å¤šå€‹**éƒ½å¸‚æ›´æ–°æœƒ (1:N)
- ä¸€å€‹ä¼æ¥­å¯æœ‰**å¤šå€‹**ä½¿ç”¨è€… (1:N)

#### User (ä½¿ç”¨è€…)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `email` | ç™»å…¥å¸³è™Ÿ |
| `password` | å¯†ç¢¼ (hashed) |
| `role` | è§’è‰²ï¼š`admin` / `user` |
| `is_company_manager` | æ˜¯å¦ç‚ºä¼æ¥­ç®¡ç†è€… (boolean) |
| `company_id` | æ‰€å±¬ä¼æ¥­ ID |

**è§’è‰²èªªæ˜**ï¼š
- `admin`ï¼šç³»çµ±ç®¡ç†å“¡ï¼Œå¯å­˜å–æ‰€æœ‰è³‡æ–™
- `user` + `is_company_manager=1`ï¼šä¼æ¥­ç®¡ç†è€…ï¼Œåƒ…èƒ½å­˜å–æ‰€å±¬ä¼æ¥­çš„è³‡æ–™

---

### 3.2 éƒ½å¸‚æ›´æ–°æœƒæ ¸å¿ƒè³‡æ–™

#### UrbanRenewal (éƒ½å¸‚æ›´æ–°æœƒ)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `company_id` | æ‰€å±¬ä¼æ¥­ ID |
| `name` | æ›´æ–°æœƒåç¨± |
| `chairman_name` | ç†äº‹é•·å§“å |
| `chairman_phone` | ç†äº‹é•·é›»è©± |
| `address` | åœ°å€ |
| `representative` | ä»£è¡¨äºº |
| `assigned_admin_id` | æŒ‡æ´¾çš„ç®¡ç†å“¡ ID |

**é—œè¯**ï¼š
- å±¬æ–¼ä¸€å€‹ä¼æ¥­
- æ“æœ‰å¤šå€‹æ‰€æœ‰æ¬Šäººã€åœŸåœ°ã€å»ºç‰©ã€æœƒè­°

#### PropertyOwner (æ‰€æœ‰æ¬Šäºº)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `urban_renewal_id` | æ‰€å±¬æ›´æ–°æœƒ ID |
| `name` | å§“å |
| `id_number` | èº«åˆ†è­‰å­—è™Ÿ |
| `owner_code` | æ‰€æœ‰æ¬Šäººç·¨è™Ÿ (è‡ªå‹•ç”¢ç”Ÿ) |
| `phone1` / `phone2` | é›»è©± |
| `contact_address` | è¯çµ¡åœ°å€ |
| `household_address` | æˆ¶ç±åœ°å€ |
| `exclusion_type` | æ’é™¤é¡å‹ (è¦‹ä¸‹æ–¹èªªæ˜) |
| `notes` | å‚™è¨» |

**æ’é™¤é¡å‹ (exclusion_type)**ï¼š
- `æ³•é™¢å›‘è¨—æŸ¥å°`
- `å‡æ‰£æŠ¼`
- `å‡è™•åˆ†`
- `ç ´ç”¢ç™»è¨˜`
- `æœªç¶“ç¹¼æ‰¿`

> âš ï¸ **é‡è¦**ï¼šå…·æœ‰ `exclusion_type` çš„æ‰€æœ‰æ¬Šäºº**ä¸ç´å…¥è¨ˆç®—**ï¼ˆå‡ºå¸­çµ±è¨ˆã€æŠ•ç¥¨çµ±è¨ˆï¼‰

---

### 3.3 åœŸåœ°èˆ‡å»ºç‰©

#### LandPlot (åœŸåœ°)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `urban_renewal_id` | æ‰€å±¬æ›´æ–°æœƒ ID |
| `county` / `district` / `section` | ç¸£å¸‚/é„‰é®å€/æ®µ |
| `land_number_main` / `land_number_sub` | åœ°è™Ÿ (æ¯è™Ÿ/å­è™Ÿ) |
| `land_area` | åœŸåœ°é¢ç© (å¹³æ–¹å…¬å°º) |

#### Building (å»ºç‰©)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `urban_renewal_id` | æ‰€å±¬æ›´æ–°æœƒ ID |
| `county` / `district` / `section` | ç¸£å¸‚/é„‰é®å€/æ®µ |
| `building_number_main` / `building_number_sub` | å»ºè™Ÿ (æ¯è™Ÿ/å­è™Ÿ) |
| `building_area` | å»ºç‰©é¢ç© (å¹³æ–¹å…¬å°º) |
| `building_address` | å»ºç‰©åœ°å€ |

#### OwnerLandOwnership / OwnerBuildingOwnership (æ‰€æœ‰æ¬Šé—œè¯)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `property_owner_id` | æ‰€æœ‰æ¬Šäºº ID |
| `land_plot_id` / `building_id` | åœŸåœ°/å»ºç‰© ID |
| `ownership_numerator` | æŒåˆ†åˆ†å­ |
| `ownership_denominator` | æŒåˆ†åˆ†æ¯ |

> ğŸ’¡ æ‰€æœ‰æ¬Šäººèˆ‡åœŸåœ°/å»ºç‰©ç‚º **N:M é—œä¿‚**ï¼Œé€éä¸­ä»‹è¡¨è¨˜éŒ„æŒåˆ†æ¯”ä¾‹ã€‚

---

### 3.4 æœƒè­°ç®¡ç†

#### Meeting (æœƒè­°)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `urban_renewal_id` | æ‰€å±¬æ›´æ–°æœƒ ID |
| `meeting_name` | æœƒè­°åç¨± |
| `meeting_type` | é¡å‹ï¼šæœƒå“¡å¤§æœƒ / ç†äº‹æœƒ / ç›£äº‹æœƒ / è‡¨æ™‚æœƒè­° |
| `meeting_date` / `meeting_time` | æ—¥æœŸ / æ™‚é–“ |
| `meeting_location` | åœ°é» |
| `meeting_status` | ç‹€æ…‹ï¼šdraft / scheduled / in_progress / completed / cancelled |
| `attendee_count` | å‡ºå¸­äººæ•¸ |
| `calculated_total_count` | ç´å…¥è¨ˆç®—ç¸½äººæ•¸ |
| `quorum_*` | æˆæœƒé–€æª»ç›¸é—œæ¬„ä½ |

**ç‹€æ…‹æµç¨‹**ï¼š
```
draft â†’ scheduled â†’ in_progress â†’ completed
  â†“         â†“            â†“
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â†’ cancelled
```

#### MeetingEligibleVoter (åˆæ ¼æŠ•ç¥¨äººå¿«ç…§)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `meeting_id` | æœƒè­° ID |
| `property_owner_id` | æ‰€æœ‰æ¬Šäºº ID |
| `owner_name` | æ‰€æœ‰æ¬Šäººå§“å (å¿«ç…§) |
| `owner_code` | æ‰€æœ‰æ¬Šäººç·¨è™Ÿ (å¿«ç…§) |
| `id_number` | èº«åˆ†è­‰å­—è™Ÿ (å¿«ç…§) |
| `land_area_weight` | åœŸåœ°é¢ç©æ¬Šé‡ (å¿«ç…§) |
| `building_area_weight` | å»ºç‰©é¢ç©æ¬Šé‡ (å¿«ç…§) |
| `snapshot_at` | å¿«ç…§æ™‚é–“ |

> ğŸ’¡ **é‡è¦**ï¼šæ­¤è¡¨è¨˜éŒ„æœƒè­°å»ºç«‹ç•¶ä¸‹çš„åˆæ ¼æŠ•ç¥¨äººåå–®ï¼Œç¢ºä¿æŠ•ç¥¨æ™‚ä»¥æ­¤åå–®ç‚ºæº–ï¼Œä¸å—å¾ŒçºŒç”¢æ¬Šç•°å‹•å½±éŸ¿ã€‚

#### MeetingAttendance (å‡ºå¸­ç´€éŒ„)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `meeting_id` | æœƒè­° ID |
| `property_owner_id` | æ‰€æœ‰æ¬Šäºº ID |
| `attendance_type` | é¡å‹ï¼špresent (è¦ªè‡ªå‡ºå¸­) / proxy (å§”è¨—å‡ºå¸­) / absent (æœªå‡ºå¸­) |
| `proxy_person` | ä»£ç†äººå§“å |
| `check_in_time` | å ±åˆ°æ™‚é–“ |
| `is_calculated` | æ˜¯å¦ç´å…¥è¨ˆç®— (boolean) |

---

### 3.5 æŠ•ç¥¨ç³»çµ±

#### VotingTopic (æŠ•ç¥¨è­°é¡Œ)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `meeting_id` | æ‰€å±¬æœƒè­° ID |
| `topic_number` | è­°é¡Œç·¨è™Ÿ |
| `topic_title` | è­°é¡Œæ¨™é¡Œ |
| `topic_description` | è­°é¡Œèªªæ˜ |
| `voting_method` | æŠ•ç¥¨æ–¹å¼ (è¦‹ä¸‹æ–¹) |
| `is_anonymous` | æ˜¯å¦åŒ¿åæŠ•ç¥¨ |
| `voting_status` | ç‹€æ…‹ï¼šdraft / active / closed |
| `voting_result` | çµæœï¼špending / passed / failed / withdrawn |
| `total_votes` / `agree_votes` / `disagree_votes` / `abstain_votes` | ç¥¨æ•¸çµ±è¨ˆ |
| `total_land_area` / `agree_land_area` / ... | åœŸåœ°é¢ç©æ¬Šé‡çµ±è¨ˆ |
| `total_building_area` / `agree_building_area` / ... | å»ºç‰©é¢ç©æ¬Šé‡çµ±è¨ˆ |

**æŠ•ç¥¨æ–¹å¼ (voting_method)**ï¼š
- `simple_majority`ï¼šç°¡å–®å¤šæ•¸ (>50%)
- `absolute_majority`ï¼šçµ•å°å¤šæ•¸ (â‰¥50%)
- `two_thirds_majority`ï¼šä¸‰åˆ†ä¹‹äºŒå¤šæ•¸ (â‰¥66.67%)
- `unanimous`ï¼šå…¨æ•¸åŒæ„

**ç‹€æ…‹æµç¨‹**ï¼š
```
draft â†’ active â†’ closed
```

#### VotingRecord (æŠ•ç¥¨ç´€éŒ„)
| æ¬„ä½ | èªªæ˜ |
|------|------|
| `id` | ä¸»éµ |
| `voting_topic_id` | æŠ•ç¥¨è­°é¡Œ ID |
| `property_owner_id` | æ‰€æœ‰æ¬Šäºº ID |
| `vote_choice` | é¸æ“‡ï¼šagree / disagree / abstain |
| `vote_time` | æŠ•ç¥¨æ™‚é–“ |
| `voter_name` | æŠ•ç¥¨äººå§“å |
| `land_area_weight` | åœŸåœ°é¢ç©æ¬Šé‡ |
| `building_area_weight` | å»ºç‰©é¢ç©æ¬Šé‡ |
| `notes` | å‚™è¨» |

---

## 4. æ¥­å‹™é‚è¼¯èªªæ˜

### 4.1 æ‰€æœ‰æ¬Šäººè¨ˆç®—é‚è¼¯

**ã€Œç´å…¥è¨ˆç®—ã€çš„æ‰€æœ‰æ¬Šäºº**æŒ‡çš„æ˜¯ï¼š
- å±¬æ–¼è©²éƒ½å¸‚æ›´æ–°æœƒçš„æ‰€æœ‰æ¬Šäºº
- **ä¸”** `exclusion_type` ç‚ºç©º (NULL)

```php
// å–å¾—ç´å…¥è¨ˆç®—çš„æ‰€æœ‰æ¬Šäºº
$validOwners = $propertyOwnerModel
    ->where('urban_renewal_id', $urbanRenewalId)
    ->where('exclusion_type', null)
    ->findAll();
```

### 4.2 æŠ•ç¥¨è³‡æ ¼åˆ¤å®š

ç³»çµ±æ¡ç”¨**å¿«ç…§æ¨¡å¼**ï¼š
1. **æœƒè­°å»ºç«‹æ™‚**ï¼Œè‡ªå‹•å»ºç«‹ã€Œåˆæ ¼æŠ•ç¥¨äººå¿«ç…§ã€(`meeting_eligible_voters`)ã€‚
2. å¿«ç…§åŒ…å«ç•¶ä¸‹ã€Œç´å…¥è¨ˆç®—ã€çš„æ‰€æœ‰æ¬ŠäººåŠå…¶æ¬Šé‡è³‡æ–™ã€‚
3. **æŠ•ç¥¨æ™‚**ï¼Œä»¥å¿«ç…§åå–®ç‚ºæº–ï¼Œä¸å—å¾ŒçºŒç”¢æ¬Šç•°å‹•å½±éŸ¿ã€‚
4. è‰ç¨¿æˆ–å·²æ’ç¨‹çš„æœƒè­°å¯é€é API é‡æ–°æ•´ç†å¿«ç…§ã€‚

```php
// æœƒè­°å»ºç«‹æ™‚è‡ªå‹•å»ºç«‹å¿«ç…§
$eligibleVoterModel = model('MeetingEligibleVoterModel');
$snapshotResult = $eligibleVoterModel->createSnapshot($meetingId, $urbanRenewalId);
```

**ç›¸é—œ API**ï¼š
- `GET /api/meetings/{id}/eligible-voters` - å–å¾—å¿«ç…§åå–®
- `POST /api/meetings/{id}/eligible-voters/refresh` - é‡æ–°æ•´ç†å¿«ç…§

### 4.3 æŠ•ç¥¨çµæœè¨ˆç®—

```php
// åŒæ„æ¯”ä¾‹è¨ˆç®—
$agreeLandPercentage = ($agree_land_area / $total_land_area) * 100;
$agreeBuildingPercentage = ($agree_building_area / $total_building_area) * 100;
$agreeVotePercentage = ($agree_votes / $total_votes) * 100;

// åˆ¤å®šæ˜¯å¦é€šé (ä»¥ simple_majority ç‚ºä¾‹)
if ($agreeLandPercentage > 50 && 
    $agreeBuildingPercentage > 50 && 
    $agreeVotePercentage > 50) {
    $result = 'passed';
}
```

### 4.4 æˆæœƒé–€æª»è¨ˆç®—

æœƒè­°çš„æˆæœƒé–€æª»éœ€åŒæ™‚æ»¿è¶³ä¸‰å€‹æ¢ä»¶ï¼š
1. **åœŸåœ°é¢ç©æ¯”ä¾‹**ï¼šå‡ºå¸­è€…åœŸåœ°é¢ç© Ã· ç¸½åœŸåœ°é¢ç© â‰¥ é–€æª»
2. **å»ºç‰©é¢ç©æ¯”ä¾‹**ï¼šå‡ºå¸­è€…å»ºç‰©é¢ç© Ã· ç¸½å»ºç‰©é¢ç© â‰¥ é–€æª»
3. **äººæ•¸æ¯”ä¾‹**ï¼šå‡ºå¸­äººæ•¸ Ã· ç¸½äººæ•¸ â‰¥ é–€æª»

---

## 5. API è·¯ç”±å°ç…§è¡¨

### 5.1 èªè­‰ç›¸é—œ
| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|------|------|------|
| POST | `/api/auth/login` | ç™»å…¥ |
| POST | `/api/auth/logout` | ç™»å‡º |
| GET | `/api/auth/me` | å–å¾—ç•¶å‰ä½¿ç”¨è€…è³‡è¨Š |

### 5.2 éƒ½å¸‚æ›´æ–°æœƒ
| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|------|------|------|
| GET | `/api/urban-renewals` | åˆ—è¡¨ |
| GET | `/api/urban-renewals/{id}` | è©³æƒ… |
| GET | `/api/urban-renewals/{id}/property-owners` | æ‰€æœ‰æ¬Šäººåˆ—è¡¨ |
| GET | `/api/urban-renewals/{id}/land-plots` | åœŸåœ°åˆ—è¡¨ |

### 5.3 æœƒè­°
| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|------|------|------|
| GET | `/api/meetings` | åˆ—è¡¨ |
| GET | `/api/meetings/{id}` | è©³æƒ… |
| POST | `/api/meetings` | å»ºç«‹ |
| PUT | `/api/meetings/{id}` | æ›´æ–° |
| GET | `/api/meetings/{id}/attendances` | å‡ºå¸­ç´€éŒ„ |
| POST | `/api/meetings/{id}/attendances/{ownerId}` | å ±åˆ° |

### 5.4 æŠ•ç¥¨è­°é¡Œ
| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|------|------|------|
| GET | `/api/voting-topics?meeting_id={id}` | åˆ—è¡¨ |
| GET | `/api/voting-topics/{id}` | è©³æƒ… |
| POST | `/api/voting-topics` | å»ºç«‹ |
| PATCH | `/api/voting-topics/{id}/start-voting` | é–‹å§‹æŠ•ç¥¨ |
| PATCH | `/api/voting-topics/{id}/close-voting` | çµæŸæŠ•ç¥¨ |

### 5.5 æŠ•ç¥¨
| æ–¹æ³• | è·¯å¾‘ | èªªæ˜ |
|------|------|------|
| GET | `/api/voting?topic_id={id}` | å·²æŠ•ç¥¨ç´€éŒ„åˆ—è¡¨ |
| POST | `/api/voting/vote` | æŠ•ç¥¨ |
| DELETE | `/api/voting/remove-vote` | æ’¤å›æŠ•ç¥¨ |
| GET | `/api/voting/statistics/{topicId}` | æŠ•ç¥¨çµ±è¨ˆ |

---

## 6. å‰ç«¯é é¢å°ç…§

| è·¯å¾‘ | èªªæ˜ |
|------|------|
| `/tables/urban-renewal` | éƒ½å¸‚æ›´æ–°æœƒåˆ—è¡¨ |
| `/tables/urban-renewal/[id]/basic-info` | æ›´æ–°æœƒåŸºæœ¬è³‡æ–™ç·¨è¼¯ |
| `/tables/urban-renewal/[id]/property-owners` | æ‰€æœ‰æ¬Šäººç®¡ç† |
| `/tables/meeting` | æœƒè­°åˆ—è¡¨ |
| `/tables/meeting/[id]/basic-info` | æœƒè­°åŸºæœ¬è³‡æ–™ |
| `/tables/meeting/[id]/member-checkin` | æœƒå“¡å ±åˆ° |
| `/tables/meeting/[id]/voting-topics` | æŠ•ç¥¨è­°é¡Œåˆ—è¡¨ |
| `/tables/meeting/[id]/voting-topics/[topicId]/voting` | æŠ•ç¥¨é€²è¡Œé é¢ |
| `/tables/meeting/[id]/voting-topics/[topicId]/results` | æŠ•ç¥¨çµæœé é¢ |

---

## 7. é™„éŒ„ï¼šè³‡æ–™åº«è¡¨æ¸…å–®

| è¡¨å | èªªæ˜ |
|------|------|
| `companies` | ä¼æ¥­ |
| `users` | ä½¿ç”¨è€… |
| `urban_renewals` | éƒ½å¸‚æ›´æ–°æœƒ |
| `property_owners` | æ‰€æœ‰æ¬Šäºº |
| `land_plots` | åœŸåœ° |
| `buildings` | å»ºç‰© |
| `owner_land_ownerships` | æ‰€æœ‰æ¬Šäºº-åœŸåœ°é—œè¯ |
| `owner_building_ownerships` | æ‰€æœ‰æ¬Šäºº-å»ºç‰©é—œè¯ |
| `meetings` | æœƒè­° |
| `meeting_eligible_voters` | åˆæ ¼æŠ•ç¥¨äººå¿«ç…§ |
| `meeting_attendances` | å‡ºå¸­ç´€éŒ„ |
| `meeting_observers` | åˆ—å¸­è€… |
| `voting_topics` | æŠ•ç¥¨è­°é¡Œ |
| `voting_records` | æŠ•ç¥¨ç´€éŒ„ |
| `voting_options` | æŠ•ç¥¨é¸é … (å€™é¸äºº) |
| `voting_choices` | æŠ•ç¥¨é¸æ“‡ (åŒæ„/ä¸åŒæ„) |
| `counties` / `districts` / `sections` | å°ç£è¡Œæ”¿å€åŠƒ |
| `joint_common_areas` | å…±åŒå€åŸŸ |
| `notifications` | é€šçŸ¥ |
| `system_settings` | ç³»çµ±è¨­å®š |

---

## 8. æ›´æ–°ç´€éŒ„

| ç‰ˆæœ¬ | æ—¥æœŸ | èªªæ˜ |
|------|------|------|
| 1.0 | 2025-12-06 | åˆç‰ˆå»ºç«‹ |
