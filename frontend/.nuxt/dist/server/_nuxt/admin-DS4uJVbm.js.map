{"version":3,"file":"admin-DS4uJVbm.js","sources":["../../../../middleware/admin.js"],"sourcesContent":["export default defineNuxtRouteMiddleware(async (to) => {\n  const authStore = useAuthStore()\n  \n  // Skip middleware on server-side for better SSR handling\n  if (process.server) {\n    return\n  }\n  \n  // 初始化認證狀態 (只在客戶端運行)\n  await authStore.initializeAuth()\n  \n  // 檢查是否已登入\n  if (!authStore.isLoggedIn) {\n    console.log('[Admin Middleware] User not authenticated, redirecting to login')\n    return navigateTo('/auth/login')\n  }\n  \n  // 嘗試驗證token是否仍然有效 (但不要太頻繁)\n  try {\n    // 只有當用戶數據不存在時才重新獲取\n    if (!authStore.user) {\n      await authStore.fetchUser()\n    }\n  } catch (error) {\n    console.warn('[Admin Middleware] Token validation failed:', error.message)\n    return navigateTo('/auth/login')\n  }\n  \n  // 檢查是否有管理員權限\n  if (!authStore.isAdmin) {\n    console.log('[Admin Middleware] User is not admin, access denied')\n    throw createError({\n      statusCode: 403,\n      statusMessage: 'Access denied. Administrator privileges required.'\n    })\n  }\n})"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AACE,MAAA,kCAA+B,OAAA,OAAA;AAGX,eAAA;AAClB;AACF;AAAA,EAGA;;"}