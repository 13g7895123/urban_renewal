import{Z as o,$ as n,a0 as a,i as r,a1 as d}from"./Ci9T5MJN.js";const u=o(async c=>{let t,i;const e=n();if([t,i]=a(()=>e.initializeAuth()),await t,i(),!e.isLoggedIn)return console.log("[Admin Middleware] User not authenticated, redirecting to login"),r("/auth/login");try{e.user||([t,i]=a(()=>e.fetchUser()),await t,i())}catch(s){return console.warn("[Admin Middleware] Token validation failed:",s.message),r("/auth/login")}if(!e.isAdmin)throw console.log("[Admin Middleware] User is not admin, access denied"),d({statusCode:403,statusMessage:"Access denied. Administrator privileges required."})});export{u as default};
